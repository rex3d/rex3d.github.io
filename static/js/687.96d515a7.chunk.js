"use strict";(self.webpackChunkrex3d_website=self.webpackChunkrex3d_website||[]).push([[687],{948:(e,s,a)=>{a.d(s,{A:()=>o});var t=a(9379),r=a(5043),n=a(4210),i=a(579);const l=e=>{let{rating:s,onRatingChange:a}=e;const[t,n]=(0,r.useState)(0),l=Array.from({length:5},(e,s)=>s+1);return(0,i.jsx)("div",{children:l.map(e=>(0,i.jsx)("span",{className:"star",style:{cursor:"pointer",color:e<=(t||s)?"gold":"gray"},onClick:()=>a(e),onMouseEnter:()=>n(e),onMouseLeave:()=>n(0),children:"\u2605"},e))})},o=e=>{let{productSku:s,productName:a,onSubmitSuccess:o}=e;const[c,d]=(0,r.useState)({autor:"",komentarz:"",rating:5,sku:s||""}),[m,u]=(0,r.useState)({isLoading:!1,error:null}),h=e=>{const{name:s,value:a}=e.target;d(e=>(0,t.A)((0,t.A)({},e),{},{[s]:a}))};return(0,i.jsx)("div",{className:"card mb-4",children:(0,i.jsxs)("div",{className:"card-body",children:[(0,i.jsx)("h5",{className:"card-title",children:"Dodaj swoj\u0105 opini\u0119"}),a&&(0,i.jsxs)("p",{className:"text-muted",children:["Oceniasz produkt: ",(0,i.jsx)("strong",{children:a})]}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!c.autor||!c.komentarz)return void u({isLoading:!1,error:"Wype\u0142nij wszystkie pola."});u({isLoading:!0,error:null});const a={autor:c.autor,komentarz:c.komentarz,rating:parseInt(c.rating,10),product_sku:c.sku||null},{error:t}=await n.N.from("opinie").insert([a]);t?(console.error("Error adding opinion: ",t),u({isLoading:!1,error:"Wyst\u0105pi\u0142 b\u0142\u0105d podczas dodawania opinii."})):(u({isLoading:!1,error:null}),d({autor:"",komentarz:"",rating:5,sku:s||""}),o&&o())},children:[!s&&(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{htmlFor:"sku",className:"form-label",children:"SKU Produktu (opcjonalnie)"}),(0,i.jsx)("input",{type:"text",className:"form-control",id:"sku",name:"sku",value:c.sku,onChange:h})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{htmlFor:"author",className:"form-label",children:"Twoje imi\u0119"}),(0,i.jsx)("input",{type:"text",className:"form-control",id:"author",name:"autor",value:c.autor,onChange:h,required:!0})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{htmlFor:"text",className:"form-label",children:"Tre\u015b\u0107 opinii"}),(0,i.jsx)("textarea",{className:"form-control",id:"text",name:"komentarz",rows:"3",value:c.komentarz,onChange:h,required:!0})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{className:"form-label",children:"Ocena:"}),(0,i.jsx)(l,{rating:c.rating,onRatingChange:e=>d(s=>(0,t.A)((0,t.A)({},s),{},{rating:e}))})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary mt-3",disabled:m.isLoading,children:m.isLoading?"Dodawanie...":"Dodaj Opini\u0119"}),m.error&&(0,i.jsx)("p",{className:"text-danger mt-2",children:m.error})]})]})})}},5220:(e,s,a)=>{a.d(s,{A:()=>r});a(5043);var t=a(579);const r=e=>{let{rating:s}=e;const a=Number(s)||0,r=[];for(let n=1;n<=5;n++)n<=a?r.push((0,t.jsx)("span",{className:"text-warning",children:"\u2605"},n)):r.push((0,t.jsx)("span",{className:"text-muted",children:"\u2606"},n));return(0,t.jsx)("div",{children:r})}},9687:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var t=a(9379),r=a(5043),n=a(9981),i=a(4210),l=a(5220),o=a(948),c=a(579);const d=()=>(0,c.jsx)("div",{className:"col-md-6 mb-4",children:(0,c.jsx)("div",{className:"card h-100 skeleton-card",children:(0,c.jsxs)("div",{className:"card-body",children:[(0,c.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,c.jsx)("div",{className:"skeleton-text skeleton-title",style:{width:"50%"}}),(0,c.jsx)("div",{className:"skeleton-text",style:{width:"30%",height:"1rem"}})]}),(0,c.jsx)("div",{className:"skeleton-text",style:{width:"40%",height:"1.5rem"}})," ",(0,c.jsx)("div",{className:"skeleton-text skeleton-line-1 mt-3"}),(0,c.jsx)("div",{className:"skeleton-text skeleton-line-2"})]})})}),m=()=>{const[e,s]=(0,r.useState)([]),[a,m]=(0,r.useState)({isLoading:!0,error:null}),[u,h]=(0,r.useState)(""),[x,j]=(0,r.useState)([]),g=(0,n.zy)(),p=new URLSearchParams(g.search).get("sku"),N=(0,r.useMemo)(()=>{if(0===e.length)return 0;return e.reduce((e,s)=>e+s.rating,0)/e.length},[e]),b=(0,r.useCallback)(async()=>{m(e=>(0,t.A)((0,t.A)({},e),{},{isLoading:!0}));const{data:e,error:a}=await i.N.from("opinie").select("*").order("created_at",{ascending:!1});a?(console.error("Error fetching opinions:",a),m(e=>(0,t.A)((0,t.A)({},e),{},{error:"Nie uda\u0142o si\u0119 za\u0142adowa\u0107 opinii.",isLoading:!1}))):(s(e),m(e=>(0,t.A)((0,t.A)({},e),{},{isLoading:!1,error:null})))},[]);(0,r.useEffect)(()=>{b()},[b]),(0,r.useEffect)(()=>{fetch("/products.json").then(e=>e.json()).then(e=>j(e)).catch(e=>console.error("Error fetching products:",e))},[]),(0,r.useEffect)(()=>{if(p&&x.length>0){const e=x.find(e=>String(e.sku)===p);e&&h(e.name)}},[p,x]);const k=e=>{const s=x.find(s=>String(s.sku)===String(e));return s?s.name:e};return(0,c.jsxs)("div",{className:"container mt-5 pt-5",children:[(0,c.jsx)("h2",{className:"text-center mb-4",children:"Opinie Klient\xf3w"}),(0,c.jsx)(o.A,{productSku:p,productName:u,onSubmitSuccess:b}),(0,c.jsxs)("div",{className:"card mb-4 text-center p-3 shadow-sm",children:[(0,c.jsx)("h4",{className:"mb-2",children:"Podsumowanie Opinii"}),e.length>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("h5",{className:"mb-1",children:["\u015arednia ocena: ",(0,c.jsxs)("span",{className:"text-primary fw-bold",children:[N.toFixed(1)," / 5"]})]}),(0,c.jsxs)("p",{className:"text-muted",children:["Na podstawie ",e.length," opinii"]})]}):(0,c.jsx)("p",{className:"text-muted",children:"Brak opinii do wy\u015bwietlenia."})]}),(0,c.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,c.jsxs)("h4",{className:"mb-0",children:["Wszystkie opinie (",e.length,")"]},e.length),(0,c.jsx)("button",{onClick:b,className:"btn btn-outline-secondary btn-sm",disabled:a.isLoading,children:a.isLoading?"\u0141adowanie...":"Od\u015bwie\u017c"})]}),a.isLoading?(0,c.jsx)("div",{className:"row",children:Array.from({length:4}).map((e,s)=>(0,c.jsx)(d,{},s))}):0===e.length?(0,c.jsx)("div",{className:"alert alert-info text-center",role:"alert",children:"Brak opinii. B\u0105d\u017a pierwszy i dodaj swoj\u0105!"}):(0,c.jsx)("div",{className:"row",children:e.map(e=>(0,c.jsx)("div",{className:"col-md-6 mb-4",children:(0,c.jsx)("div",{className:"card h-100 shadow-sm",children:(0,c.jsxs)("div",{className:"card-body",children:[(0,c.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,c.jsx)("h5",{className:"card-title mb-0",children:e.autor||"Anonim"}),(0,c.jsx)("small",{className:"text-muted",children:e.created_at?new Date(e.created_at).toLocaleDateString():"Brak daty"})]}),(0,c.jsx)(l.A,{rating:e.rating}),(0,c.jsx)("p",{className:"card-text mt-2",children:e.komentarz}),e.product_sku&&(0,c.jsxs)("small",{className:"text-muted",children:["Opinia o produkcie: ",(0,c.jsx)("strong",{children:k(e.product_sku)})]})]})})},e.id))})]})}}}]);
//# sourceMappingURL=687.96d515a7.chunk.js.map